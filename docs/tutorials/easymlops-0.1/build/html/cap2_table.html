<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Table任务 &mdash; EasyMLOps  文档</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/translations.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="NLP任务" href="cap3_nlp.html" />
    <link rel="prev" title="简介&amp;安装&amp;反馈" href="cap1_introduce.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            EasyMLOps
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">EasyMLOps使用文档</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="cap1_introduce.html">简介&amp;安装&amp;反馈</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Table任务</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">数据清洗</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">基础操作</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fillna">FillNa空值填充</a></li>
<li class="toctree-l3"><a class="reference internal" href="#replace">Replace</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clip">Clip操作</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mapvalues">MapValues 值映射操作</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">归一化操作</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bins">Bins分箱操作</a></li>
<li class="toctree-l3"><a class="reference internal" href="#datedaydiff">DateDayDiff：日期差</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">四则运算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">比较运算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#is-null-is-not-null">is null,is not null 运算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#andor">And与Or</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id6">特征编码</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">特征降维</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id8">特征选择</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">过滤式</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">嵌入式</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id11">分类</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id12">回归建模</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stacking">Stacking建模</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cap3_nlp.html">NLP任务</a></li>
<li class="toctree-l1"><a class="reference internal" href="cap4_mem_opt.html">内存优化</a></li>
<li class="toctree-l1"><a class="reference internal" href="cap5_persistence.html">持久化</a></li>
<li class="toctree-l1"><a class="reference internal" href="cap6_pipe.html">自定义pipe模块</a></li>
<li class="toctree-l1"><a class="reference internal" href="cap7_pipeline.html">pipeline操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="cap8_deploy.html">生产部署</a></li>
<li class="toctree-l1"><a class="reference internal" href="cap9_storage.html">特征存储&amp;监控&amp;分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="easymlops.html">API Refrence(Version=0.1.1)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EasyMLOps</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Table任务</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cap2_table.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="table">
<h1>Table任务<a class="headerlink" href="#table" title="此标题的永久链接">¶</a></h1>
<p>这里以titanic生存数据集为例，介绍相关模块的使用方法</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#数据准备</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&quot;../../&quot;</span><span class="p">)</span><span class="c1">#与easymlops同级目录</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;./data/demo.csv&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;date1&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;2020-03-06&quot;</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;date2&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;2023-01-04&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|    |   PassengerId |   Survived |   Pclass | Name                                                | Sex    |   Age |   SibSp |   Parch | Ticket           |    Fare | Cabin   | Embarked   | date1      | date2      |
|---:|--------------:|-----------:|---------:|:----------------------------------------------------|:-------|------:|--------:|--------:|:-----------------|--------:|:--------|:-----------|:-----------|:-----------|
|  0 |             1 |          0 |        3 | Braund, Mr. Owen Harris                             | male   |    22 |       1 |       0 | A/5 21171        |  7.25   | nan     | S          | 2020-03-06 | 2023-01-04 |
|  1 |             2 |          1 |        1 | Cumings, Mrs. John Bradley (Florence Briggs Thayer) | female |    38 |       1 |       0 | PC 17599         | 71.2833 | C85     | C          | 2020-03-06 | 2023-01-04 |
|  2 |             3 |          1 |        3 | Heikkinen, Miss. Laina                              | female |    26 |       0 |       0 | STON/O2. 3101282 |  7.925  | nan     | S          | 2020-03-06 | 2023-01-04 |
|  3 |             4 |          1 |        1 | Futrelle, Mrs. Jacques Heath (Lily May Peel)        | female |    35 |       1 |       0 | 113803           | 53.1    | C123    | S          | 2020-03-06 | 2023-01-04 |
|  4 |             5 |          0 |        3 | Allen, Mr. William Henry                            | male   |    35 |       0 |       0 | 373450           |  8.05   | nan     | S          | 2020-03-06 | 2023-01-04 |
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x_train</span><span class="o">=</span><span class="n">data</span><span class="p">[:</span><span class="mi">500</span><span class="p">]</span>
<span class="n">x_test</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">500</span><span class="p">:]</span>
<span class="n">y_train</span><span class="o">=</span><span class="n">x_train</span><span class="p">[</span><span class="s2">&quot;Survived&quot;</span><span class="p">]</span>
<span class="n">y_test</span><span class="o">=</span><span class="n">x_test</span><span class="p">[</span><span class="s2">&quot;Survived&quot;</span><span class="p">]</span>
<span class="k">del</span> <span class="n">x_train</span><span class="p">[</span><span class="s2">&quot;Survived&quot;</span><span class="p">]</span>
<span class="k">del</span> <span class="n">x_test</span><span class="p">[</span><span class="s2">&quot;Survived&quot;</span><span class="p">]</span>
</pre></div>
</div>
<section id="id1">
<h2>数据清洗<a class="headerlink" href="#id1" title="此标题的永久链接">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">easymlops</span> <span class="kn">import</span> <span class="n">TablePipeLine</span>
<span class="kn">from</span> <span class="nn">easymlops.table.preprocessing</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">easymlops.table.ensemble</span> <span class="kn">import</span> <span class="n">Parallel</span>
</pre></div>
</div>
<section id="id2">
<h3>基础操作<a class="headerlink" href="#id2" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>FixInput：固定输入column的顺序、数据类型（这个模块十分重要，所有table任务第一个pipe建议是它）</p></li>
<li><p>TransToCategory、TransToFloat、TransToInt：分别转换为类别、浮点、整型数据</p></li>
<li><p>TransToLower、TransToUpper：英文转小写、大写</p></li>
<li><p>ReName：修改col名称</p></li>
<li><p>SelectCols：选择特定的cols</p></li>
<li><p>DropCols：删除特定的cols</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">TransToCategory</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Cabin&quot;</span><span class="p">,</span><span class="s2">&quot;Embarked&quot;</span><span class="p">,</span><span class="s2">&quot;Name&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">TransToFloat</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="s2">&quot;Fare&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">TransToInt</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span><span class="s2">&quot;PassengerId&quot;</span><span class="p">,</span><span class="s2">&quot;SibSp&quot;</span><span class="p">,</span><span class="s2">&quot;Parch&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">TransToLower</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ticket&quot;</span><span class="p">,</span><span class="s2">&quot;Cabin&quot;</span><span class="p">,</span><span class="s2">&quot;Embarked&quot;</span><span class="p">,</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span><span class="s2">&quot;Sex&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">ReName</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;PassengerId&quot;</span><span class="p">,</span><span class="s2">&quot;乘客ID&quot;</span><span class="p">)]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">SelectCols</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;乘客ID&quot;</span><span class="p">,</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="s2">&quot;Ticket&quot;</span><span class="p">,</span><span class="s2">&quot;Embarked&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">DropCols</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Embarked&quot;</span><span class="p">]))</span>

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |   乘客ID | Name                           | Sex    |   Age |   Ticket |
|----:|---------:|:-------------------------------|:-------|------:|---------:|
| 500 |      501 | calic, mr. petar               | male   |    17 |   315086 |
| 501 |      502 | canavan, miss. mary            | female |    21 |   364846 |
| 502 |      503 | o&#39;sullivan, miss. bridget mary | female |     0 |   330909 |
| 503 |      504 | laitinen, miss. kristina sofia | female |    37 |     4135 |
| 504 |      505 | maioni, miss. roberta          | female |    16 |   110152 |
</pre></div>
</div>
</section>
<section id="fillna">
<h3>FillNa空值填充<a class="headerlink" href="#fillna" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>FillNa：包括均值、中位数、众数、指定默认值的方式</p></li>
</ul>
<p>如下：</p>
<ol class="arabic simple">
<li><p>对”Cabin”,”Ticket”,”Parch”,”Fare”,”Sex”进行众数填充；</p></li>
<li><p>对”Age”进行均值填充；</p></li>
<li><p>对”Embarked”填充指定值”N”；</p></li>
<li><p>而FillNa不传任何入参，表示离散型数据按<code class="docutils literal notranslate"><span class="pre">fill_category_value=&quot;nan&quot;</span></code>填充，数值型数据按<code class="docutils literal notranslate"><span class="pre">fill_number_value=0</span></code>填充</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">SelectCols</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Cabin&quot;</span><span class="p">,</span><span class="s2">&quot;Ticket&quot;</span><span class="p">,</span><span class="s2">&quot;Parch&quot;</span><span class="p">,</span><span class="s2">&quot;Fare&quot;</span><span class="p">,</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="s2">&quot;Embarked&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Cabin&quot;</span><span class="p">,</span><span class="s2">&quot;Ticket&quot;</span><span class="p">,</span><span class="s2">&quot;Parch&quot;</span><span class="p">,</span><span class="s2">&quot;Fare&quot;</span><span class="p">,</span><span class="s2">&quot;Sex&quot;</span><span class="p">],</span><span class="n">fill_mode</span><span class="o">=</span><span class="s2">&quot;mode&quot;</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">],</span><span class="n">fill_mode</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">(</span><span class="n">fill_detail</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Embarked&quot;</span><span class="p">:</span><span class="s2">&quot;N&quot;</span><span class="p">}))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     | Cabin   |   Ticket |   Parch |     Fare | Sex    |     Age | Embarked   |
|----:|:--------|---------:|--------:|---------:|:-------|--------:|:-----------|
| 500 | nan     |   315086 |       0 |  8.66406 | male   | 17      | S          |
| 501 | nan     |   364846 |       0 |  7.75    | female | 21      | Q          |
| 502 | nan     |   330909 |       0 |  7.62891 | female | 29.2031 | Q          |
| 503 | nan     |     4135 |       0 |  9.58594 | female | 37      | S          |
| 504 | B79     |   110152 |       0 | 86.5     | female | 16      | S          |
</pre></div>
</div>
</section>
<section id="replace">
<h3>Replace<a class="headerlink" href="#replace" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>Replace：替换指定的字符串；</p></li>
</ul>
<p>注意：只有整个字符串匹配上才会替换，不会做局部替换</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">SelectCols</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span><span class="s2">&quot;Cabin&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Replace</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Cabin&quot;</span><span class="p">],</span><span class="n">source_values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;nan&quot;</span><span class="p">,</span><span class="s2">&quot;N&quot;</span><span class="p">],</span><span class="n">target_value</span><span class="o">=</span><span class="s2">&quot;nan&quot;</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Replace</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">],</span><span class="n">source_values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;male&quot;</span><span class="p">],</span><span class="n">target_value</span><span class="o">=</span><span class="s2">&quot;男&quot;</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Replace</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">],</span><span class="n">source_values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;female&quot;</span><span class="p">],</span><span class="n">target_value</span><span class="o">=</span><span class="s2">&quot;女&quot;</span><span class="p">))</span> 

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     | Sex   | Cabin   |
|----:|:------|:--------|
| 500 | 男    | nan     |
| 501 | 女    | nan     |
| 502 | 女    | nan     |
| 503 | 女    | nan     |
| 504 | 女    | B79     |
</pre></div>
</div>
</section>
<section id="clip">
<h3>Clip操作<a class="headerlink" href="#clip" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>ClipString：字符串切割；</p></li>
<li><p>Clip：对连续型变量按绝对范围或百分比切割</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>

<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">SelectCols</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="s2">&quot;Fare&quot;</span><span class="p">,</span><span class="s2">&quot;Name&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">ClipString</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">],</span><span class="n">default_clip_index</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Clip</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">],</span><span class="n">default_clip</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">99</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;clip_name&quot;</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Clip</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Fare&quot;</span><span class="p">],</span><span class="n">percent_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">99</span><span class="p">),</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;clip_fare&quot;</span><span class="p">))</span>

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |   Age |     Fare | Name       |
|----:|------:|---------:|:-----------|
| 500 |    17 |  8.66406 | Calic, Mr. |
| 501 |    21 |  7.75    | Canavan, M |
| 502 |     1 |  7.62891 | O&#39;Sullivan |
| 503 |    37 |  9.58594 | Laitinen,  |
| 504 |    16 | 86.5     | Maioni, Mi |
</pre></div>
</div>
</section>
<section id="mapvalues">
<h3>MapValues 值映射操作<a class="headerlink" href="#mapvalues" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>MapValues：将某些离散值或某些区间内的值映射为某个指定值</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>基本结构表示:[([&quot;a&quot;,&quot;b&quot;,1],&quot;c&quot;),
          (&quot;[4,5)&quot;,1),
           0] 
    []中: 
    1.第一个表示离散型映射，把&quot;a&quot;,&quot;b&quot;,1映射为&quot;c&quot; 
    2.第二个表示范围内映射，把4&lt;=x&lt;5的值，映射为1，其中&quot;[&quot;,&quot;]&quot;表示闭区间,&quot;(&quot;,&quot;)&quot;表示开区间
    3.列表的最后一个是没有匹配上的设置的默认值
</pre></div>
</div>
<p>如下表示：</p>
<ol class="arabic simple">
<li><p>把Cabin取值为”nan”和”NaN”映射为”n”</p></li>
<li><p>把Age取值为0&lt;Age&lt;10映射为1，把10&lt;=Age&lt;20映射为2,…</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>

<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">SelectCols</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Cabin&quot;</span><span class="p">,</span><span class="s2">&quot;Age&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">MapValues</span><span class="p">(</span><span class="n">map_detail</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Cabin&quot;</span><span class="p">:[([</span><span class="s2">&quot;nan&quot;</span><span class="p">,</span><span class="s2">&quot;NaN&quot;</span><span class="p">],</span><span class="s2">&quot;n&quot;</span><span class="p">)],</span><span class="s2">&quot;Age&quot;</span><span class="p">:[(</span><span class="s2">&quot;(0,10)&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="s2">&quot;[10,20)&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="s2">&quot;[20,30)&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="s2">&quot;[30,40)&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="mi">5</span><span class="p">]}))</span>

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     | Cabin   |   Age |
|----:|:--------|------:|
| 500 | n       |     2 |
| 501 | n       |     3 |
| 502 | n       |     5 |
| 503 | n       |     4 |
| 504 | B79     |     2 |
</pre></div>
</div>
</section>
<section id="id3">
<h3>归一化操作<a class="headerlink" href="#id3" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>MinMaxScaler、Normalizer：归一化</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">SelectCols</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="s2">&quot;Fare&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">MinMaxScaler</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="s2">&quot;Age_minmax&quot;</span><span class="p">)]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Normalizer</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;Fare&quot;</span><span class="p">,</span><span class="s2">&quot;Fare_normal&quot;</span><span class="p">)]))</span> 

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |   Age |     Fare |   Age_minmax |   Fare_normal |
|----:|------:|---------:|-------------:|--------------:|
| 500 |    17 |  8.66406 |         0.24 |         -0.49 |
| 501 |    21 |  7.75    |         0.3  |         -0.51 |
| 502 |     0 |  7.62891 |         0    |         -0.51 |
| 503 |    37 |  9.58594 |         0.52 |         -0.47 |
| 504 |    16 | 86.5     |         0.23 |          1.15 |
</pre></div>
</div>
</section>
<section id="bins">
<h3>Bins分箱操作<a class="headerlink" href="#bins" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>Bins：等距、等频、聚类分箱</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">SelectCols</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="s2">&quot;Fare&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Bins</span><span class="p">(</span><span class="n">n_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="s2">&quot;Age_uni&quot;</span><span class="p">)]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Bins</span><span class="p">(</span><span class="n">n_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;quantile&quot;</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="s2">&quot;Age_quan&quot;</span><span class="p">)]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Bins</span><span class="p">(</span><span class="n">n_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;kmeans&quot;</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;Fare&quot;</span><span class="p">,</span><span class="s2">&quot;Fare_km&quot;</span><span class="p">)]))</span> 

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |   Age |     Fare |   Age_uni |   Age_quan |   Fare_km |
|----:|------:|---------:|----------:|-----------:|----------:|
| 500 |    17 |  8.66406 |         2 |          1 |         0 |
| 501 |    21 |  7.75    |         2 |          2 |         0 |
| 502 |     0 |  7.62891 |         0 |          0 |         0 |
| 503 |    37 |  9.58594 |         5 |          5 |         0 |
| 504 |    16 | 86.5     |         2 |          1 |         4 |
</pre></div>
</div>
</section>
<section id="datedaydiff">
<h3>DateDayDiff：日期差<a class="headerlink" href="#datedaydiff" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>DateDayDiff：计算日期差天数</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">SelectCols</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;date1&quot;</span><span class="p">,</span><span class="s2">&quot;date2&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">DateDayDiff</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;date2&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;date1&quot;</span><span class="p">))</span>


<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     | date1      | date2      |   date2_day_diff_date1 |
|----:|:-----------|:-----------|-----------------------:|
| 500 | 2020-03-06 | 2023-01-04 |                   1034 |
| 501 | 2020-03-06 | 2023-01-04 |                   1034 |
| 502 | 2020-03-06 | 2023-01-04 |                   1034 |
| 503 | 2020-03-06 | 2023-01-04 |                   1034 |
| 504 | 2020-03-06 | 2023-01-04 |                   1034 |
</pre></div>
</div>
</section>
<section id="id4">
<h3>四则运算<a class="headerlink" href="#id4" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>Add、Subtract、Multiply、Divide、DivideExact、Mod：加减乘除、整除、求余等运算，支持两列col计算，以及单列和某个指定值计算</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">SelectCols</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span><span class="s2">&quot;SibSp&quot;</span><span class="p">,</span><span class="s2">&quot;Fare&quot;</span><span class="p">,</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="s2">&quot;PassengerId&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Parallel</span><span class="p">([</span><span class="n">Add</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;SibSp&quot;</span><span class="p">),</span>
                  <span class="n">Subtract</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;Fare&quot;</span><span class="p">),</span>
                  <span class="n">Multiply</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;Fare&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;Age&quot;</span><span class="p">),</span>
                  <span class="n">Divide</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;Fare&quot;</span><span class="p">),</span>
                  <span class="n">DivideExact</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;Pclass&quot;</span><span class="p">),</span>
                  <span class="n">Mod</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;PassengerId&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;Pclass&quot;</span><span class="p">)]))</span>


<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |   Pclass_add_SibSp |   Pclass_subtract_Fare |   Fare_multiply_Age |   Age_divide_Fare |   Age_divide_exact_Pclass |   Pclass |   SibSp |     Fare |   Age |   PassengerId |   PassengerId_mod_Pclass |
|----:|-------------------:|-----------------------:|--------------------:|------------------:|--------------------------:|---------:|--------:|---------:|------:|--------------:|-------------------------:|
| 500 |                  3 |               -5.66406 |              147.25 |          1.96191  |                         5 |        3 |       0 |  8.66406 |    17 |           501 |                        0 |
| 501 |                  3 |               -4.75    |              162.75 |          2.70898  |                         7 |        3 |       0 |  7.75    |    21 |           502 |                        1 |
| 502 |                  3 |               -4.62891 |                0    |          0        |                         0 |        3 |       0 |  7.62891 |     0 |           503 |                        2 |
| 503 |                  3 |               -6.58594 |              354.75 |          3.85938  |                        12 |        3 |       0 |  9.58594 |    37 |           504 |                        0 |
| 504 |                  1 |              -85.5     |             1384    |          0.184937 |                        16 |        1 |       0 | 86.5     |    16 |           505 |                        0 |
</pre></div>
</div>
</section>
<section id="id5">
<h3>比较运算<a class="headerlink" href="#id5" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>Equal、GreaterThan、GreaterEqualThan、LessThan、LessEqualThan：=,&gt;,&gt;=,&lt;,&lt;=等比较操作，如果为True返回1，False返回0</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">SelectCols</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span><span class="s2">&quot;SibSp&quot;</span><span class="p">,</span><span class="s2">&quot;Fare&quot;</span><span class="p">,</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="s2">&quot;PassengerId&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Parallel</span><span class="p">([</span><span class="n">Equal</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;SibSp&quot;</span><span class="p">),</span>
                  <span class="n">GreaterThan</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;Fare&quot;</span><span class="p">),</span>
                  <span class="n">GreaterEqualThan</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;Fare&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;Age&quot;</span><span class="p">),</span>
                  <span class="n">LessThan</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;Fare&quot;</span><span class="p">),</span>
                  <span class="n">LessEqualThan</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;Age&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;Pclass&quot;</span><span class="p">)]))</span>

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |   Pclass_equal_SibSp |   Pclass_greater_than_Fare |   Fare_greater_equal_than_Age |   Age_less_than_Fare |   Pclass |   SibSp |     Fare |   Age |   PassengerId |   Age_less_equal_than_Pclass |
|----:|---------------------:|---------------------------:|------------------------------:|---------------------:|---------:|--------:|---------:|------:|--------------:|-----------------------------:|
| 500 |                    0 |                          0 |                             0 |                    0 |        3 |       0 |  8.66406 |    17 |           501 |                            0 |
| 501 |                    0 |                          0 |                             0 |                    0 |        3 |       0 |  7.75    |    21 |           502 |                            0 |
| 502 |                    0 |                          0 |                             1 |                    1 |        3 |       0 |  7.62891 |     0 |           503 |                            1 |
| 503 |                    0 |                          0 |                             0 |                    0 |        3 |       0 |  9.58594 |    37 |           504 |                            0 |
| 504 |                    0 |                          0 |                             1 |                    1 |        1 |       0 | 86.5     |    16 |           505 |                            0 |
</pre></div>
</div>
</section>
<section id="is-null-is-not-null">
<h3>is null,is not null 运算<a class="headerlink" href="#is-null-is-not-null" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>IsNull、IsNotNull：空与非空判断</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Parallel</span><span class="p">([</span><span class="n">IsNull</span><span class="p">(),</span><span class="n">IsNotNull</span><span class="p">()]))</span>\

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |   PassengerId_is_null |   Pclass_is_null |   Name_is_null |   Sex_is_null |   Age_is_null |   SibSp_is_null |   Parch_is_null |   Ticket_is_null |   Fare_is_null |   Cabin_is_null |   Embarked_is_null |   date1_is_null |   date2_is_null |   PassengerId |   Pclass | Name                           | Sex    |   Age |   SibSp |   Parch |   Ticket |     Fare | Cabin   | Embarked   | date1      | date2      |   PassengerId_is_not_null |   Pclass_is_not_null |   Name_is_not_null |   Sex_is_not_null |   Age_is_not_null |   SibSp_is_not_null |   Parch_is_not_null |   Ticket_is_not_null |   Fare_is_not_null |   Cabin_is_not_null |   Embarked_is_not_null |   date1_is_not_null |   date2_is_not_null |
|----:|----------------------:|-----------------:|---------------:|--------------:|--------------:|----------------:|----------------:|-----------------:|---------------:|----------------:|-------------------:|----------------:|----------------:|--------------:|---------:|:-------------------------------|:-------|------:|--------:|--------:|---------:|---------:|:--------|:-----------|:-----------|:-----------|--------------------------:|---------------------:|-------------------:|------------------:|------------------:|--------------------:|--------------------:|---------------------:|-------------------:|--------------------:|-----------------------:|--------------------:|--------------------:|
| 500 |                     0 |                0 |              0 |             0 |             0 |               0 |               0 |                0 |              0 |               1 |                  0 |               0 |               0 |           501 |        3 | Calic, Mr. Petar               | male   |    17 |       0 |       0 |   315086 |  8.66406 | nan     | S          | 2020-03-06 | 2023-01-04 |                         1 |                    1 |                  1 |                 1 |                 1 |                   1 |                   1 |                    1 |                  1 |                   0 |                      1 |                   1 |                   1 |
| 501 |                     0 |                0 |              0 |             0 |             0 |               0 |               0 |                0 |              0 |               1 |                  0 |               0 |               0 |           502 |        3 | Canavan, Miss. Mary            | female |    21 |       0 |       0 |   364846 |  7.75    | nan     | Q          | 2020-03-06 | 2023-01-04 |                         1 |                    1 |                  1 |                 1 |                 1 |                   1 |                   1 |                    1 |                  1 |                   0 |                      1 |                   1 |                   1 |
| 502 |                     0 |                0 |              0 |             0 |             1 |               0 |               0 |                0 |              0 |               1 |                  0 |               0 |               0 |           503 |        3 | O&#39;Sullivan, Miss. Bridget Mary | female |   nan |       0 |       0 |   330909 |  7.62891 | nan     | Q          | 2020-03-06 | 2023-01-04 |                         1 |                    1 |                  1 |                 1 |                 0 |                   1 |                   1 |                    1 |                  1 |                   0 |                      1 |                   1 |                   1 |
| 503 |                     0 |                0 |              0 |             0 |             0 |               0 |               0 |                0 |              0 |               1 |                  0 |               0 |               0 |           504 |        3 | Laitinen, Miss. Kristina Sofia | female |    37 |       0 |       0 |     4135 |  9.58594 | nan     | S          | 2020-03-06 | 2023-01-04 |                         1 |                    1 |                  1 |                 1 |                 1 |                   1 |                   1 |                    1 |                  1 |                   0 |                      1 |                   1 |                   1 |
| 504 |                     0 |                0 |              0 |             0 |             0 |               0 |               0 |                0 |              0 |               0 |                  0 |               0 |               0 |           505 |        1 | Maioni, Miss. Roberta          | female |    16 |       0 |       0 |   110152 | 86.5     | B79     | S          | 2020-03-06 | 2023-01-04 |                         1 |                    1 |                  1 |                 1 |                 1 |                   1 |                   1 |                    1 |                  1 |                   1 |                      1 |                   1 |                   1 |
</pre></div>
</div>
</section>
<section id="andor">
<h3>And与Or<a class="headerlink" href="#andor" title="此标题的永久链接">¶</a></h3>
<ul class="simple">
<li><p>And、Or：与、或操作</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">SelectCols</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PassengerId&quot;</span><span class="p">,</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span><span class="s2">&quot;SibSp&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Parallel</span><span class="p">([</span><span class="n">And</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;PassengerId&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;Pclass&quot;</span><span class="p">),</span>
                  <span class="n">Or</span><span class="p">(</span><span class="n">left_col_name</span><span class="o">=</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span><span class="n">right_col_name</span><span class="o">=</span><span class="s2">&quot;SibSp&quot;</span><span class="p">)]))</span>

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |   PassengerId_and_Pclass |   PassengerId |   Pclass |   SibSp |   Pclass_or_SibSp |
|----:|-------------------------:|--------------:|---------:|--------:|------------------:|
| 500 |                        1 |           501 |        3 |       0 |                 1 |
| 501 |                        1 |           502 |        3 |       0 |                 1 |
| 502 |                        1 |           503 |        3 |       0 |                 1 |
| 503 |                        1 |           504 |        3 |       0 |                 1 |
| 504 |                        1 |           505 |        1 |       0 |                 1 |
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">x_train</span><span class="p">[</span><span class="s2">&quot;date1&quot;</span><span class="p">]</span>
<span class="k">del</span> <span class="n">x_train</span><span class="p">[</span><span class="s2">&quot;date2&quot;</span><span class="p">]</span>
<span class="k">del</span> <span class="n">x_test</span><span class="p">[</span><span class="s2">&quot;date1&quot;</span><span class="p">]</span>
<span class="k">del</span> <span class="n">x_test</span><span class="p">[</span><span class="s2">&quot;date2&quot;</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="id6">
<h2>特征编码<a class="headerlink" href="#id6" title="此标题的永久链接">¶</a></h2>
<ul class="simple">
<li><p>OneHotEncoding：新特征以{col名称}_{变量值}的方式表示</p></li>
<li><p>LabelEncoding：将变量值map为1,2,3…</p></li>
<li><p>TargetEncoding：支持smoothing</p></li>
<li><p>WOEEncoding</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">easymlops.table.encoding</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">OneHotEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">],</span><span class="n">drop_col</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">LabelEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">TargetEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span><span class="s2">&quot;Ticket&quot;</span><span class="p">],</span><span class="n">smoothing</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">WOEEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span><span class="s2">&quot;Embarked&quot;</span><span class="p">,</span><span class="s2">&quot;Cabin&quot;</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;woe&quot;</span><span class="p">))</span>

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |   PassengerId |    Pclass |   Name |   Sex |   Age |   SibSp |   Parch |   Ticket |     Fare |    Cabin |   Embarked |   Sex_male |   Sex_female |
|----:|--------------:|----------:|-------:|------:|------:|--------:|--------:|---------:|---------:|---------:|-----------:|-----------:|-------------:|
| 500 |           501 |  0.482439 |      0 |     1 |    17 |       0 |       0 | 0        |  8.66406 | 0.299607 |   0.224849 |          1 |            0 |
| 501 |           502 |  0.482439 |      0 |     2 |    21 |       0 |       0 | 0        |  7.75    | 0.299607 |  -0.508609 |          0 |            1 |
| 502 |           503 |  0.482439 |      0 |     2 |     0 |       0 |       0 | 0        |  7.62891 | 0.299607 |  -0.508609 |          0 |            1 |
| 503 |           504 |  0.482439 |      0 |     2 |    37 |       0 |       0 | 0        |  9.58594 | 0.299607 |   0.224849 |          0 |            1 |
| 504 |           505 | -0.741789 |      0 |     2 |    16 |       0 |       0 | 0.387228 | 86.5     | 0        |   0.224849 |          0 |            1 |
</pre></div>
</div>
</section>
<section id="id7">
<h2>特征降维<a class="headerlink" href="#id7" title="此标题的永久链接">¶</a></h2>
<ul class="simple">
<li><p>PCADecomposition：PCA降维</p></li>
<li><p>NMFDecomposition：注意，对于小于0的输入，会截断为0</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">easymlops.table.decomposition</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">OneHotEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span><span class="s2">&quot;Sex&quot;</span><span class="p">],</span><span class="n">drop_col</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">LabelEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span><span class="s2">&quot;Pclass&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">TargetEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span><span class="s2">&quot;Ticket&quot;</span><span class="p">,</span><span class="s2">&quot;Embarked&quot;</span><span class="p">,</span><span class="s2">&quot;Cabin&quot;</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Parallel</span><span class="p">([</span><span class="n">PCADecomposition</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;pca&quot;</span><span class="p">),</span><span class="n">NMFDecomposition</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;nmf&quot;</span><span class="p">)]))</span>

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |   pca_0 |    pca_1 |     pca_2 |     pca_3 |   nmf_0 |    nmf_1 |       nmf_2 |      nmf_3 |
|----:|--------:|---------:|----------:|----------:|--------:|---------:|------------:|-----------:|
| 500 | 250.112 | -27.0943 |  -5.83468 | -0.180072 | 6.20683 | 0.217971 | 0.502871    | 0          |
| 501 | 251.118 | -27.7806 |  -1.80052 | -0.126844 | 6.21923 | 0.19184  | 0.6215      | 0.00316003 |
| 502 | 252.018 | -29.1482 | -22.7548  | -0.559051 | 6.2316  | 0.191844 | 0.000106315 | 0.0141703  |
| 503 | 253.218 | -25.0384 |  14.0518  |  0.198428 | 6.24398 | 0.234273 | 1.09488     | 0          |
| 504 | 255.219 |  50.4986 | -11.4019  | -1.09081  | 6.2555  | 2.23452  | 0.473346    | 0.00359195 |
</pre></div>
</div>
</section>
<section id="id8">
<h2>特征选择<a class="headerlink" href="#id8" title="此标题的永久链接">¶</a></h2>
<section id="id9">
<h3>过滤式<a class="headerlink" href="#id9" title="此标题的永久链接">¶</a></h3>
<p>通过<code class="docutils literal notranslate"><span class="pre">min_threshold</span></code>和<code class="docutils literal notranslate"><span class="pre">max_threshold</span></code>来进行筛选，如果设置为<code class="docutils literal notranslate"><span class="pre">None</span></code>表示对应方向不做约束</p>
<ul class="simple">
<li><p>MissRateFilter：缺失率</p></li>
<li><p>VarianceFilter：方差</p></li>
<li><p>PersonCorrFilter：相关系数</p></li>
<li><p>PSIFilter：PSI，主要是模型稳定性</p></li>
<li><p>Chi2Filter：主要针对离散变量</p></li>
<li><p>MutualInfoFilter：互信息</p></li>
<li><p>IVFilter：IV值，即WOE的加权和</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">easymlops.table.feature_selection</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">MissRateFilter</span><span class="p">(</span><span class="n">max_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">VarianceFilter</span><span class="p">(</span><span class="n">min_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">PersonCorrFilter</span><span class="p">(</span><span class="n">min_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;person&quot;</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">PSIFilter</span><span class="p">(</span><span class="n">oot_x</span><span class="o">=</span><span class="n">x_test</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span><span class="s2">&quot;Embarked&quot;</span><span class="p">],</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;psi&quot;</span><span class="p">,</span><span class="n">max_threshold</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">LabelEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span><span class="s2">&quot;Ticket&quot;</span><span class="p">,</span><span class="s2">&quot;Embarked&quot;</span><span class="p">,</span><span class="s2">&quot;Pclass&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">TargetEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Chi2Filter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;chi2&quot;</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">MutualInfoFilter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">IVFilter</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;iv&quot;</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span><span class="s2">&quot;Fare&quot;</span><span class="p">],</span><span class="n">min_threshold</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |   Pclass |   Name |   Sex |   Ticket |     Fare |   Embarked |
|----:|---------:|-------:|------:|---------:|---------:|-----------:|
| 500 |        1 |      0 |     1 |        0 |  8.66406 |          1 |
| 501 |        1 |      0 |     2 |        0 |  7.75    |          3 |
| 502 |        1 |      0 |     2 |        0 |  7.62891 |          3 |
| 503 |        1 |      0 |     2 |        0 |  9.58594 |          1 |
| 504 |        2 |      0 |     2 |      231 | 86.5     |          1 |
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#查看PSI分布</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">show_detail</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|    | col    | bin_value   |   ins_num |   ins_rate |   oot_num |   oot_rate |         psi |
|---:|:-------|:------------|----------:|-----------:|----------:|-----------:|------------:|
|  0 | Pclass | 3           |       279 |      0.558 |       212 |   0.542199 | 0.000453869 |
|  1 | Pclass | 1           |       116 |      0.232 |       100 |   0.255754 | 0.0023156   |
|  2 | Pclass | 2           |       105 |      0.21  |        79 |   0.202046 | 0.000307118 |
|  3 | Sex    | male        |       315 |      0.63  |       262 |   0.670077 | 0.00247163  |
|  4 | Sex    | female      |       185 |      0.37  |       129 |   0.329923 | 0.00459451  |
</pre></div>
</div>
</section>
<section id="id10">
<h3>嵌入式<a class="headerlink" href="#id10" title="此标题的永久链接">¶</a></h3>
<p>同样，通过<code class="docutils literal notranslate"><span class="pre">min_threshold</span></code>和<code class="docutils literal notranslate"><span class="pre">max_threshold</span></code>来进行筛选，如果设置为<code class="docutils literal notranslate"><span class="pre">None</span></code>表示对应方向不做约束</p>
<ul class="simple">
<li><p>LREmbed：线性模型，对系数取了绝对值做评估</p></li>
<li><p>LGBMEmbed：lgbm决策树，评估标准有<code class="docutils literal notranslate"><span class="pre">importance_type=&quot;split&quot;</span></code>（默认），以及<code class="docutils literal notranslate"><span class="pre">importance_type=&quot;gain&quot;</span></code></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">LabelEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span><span class="s2">&quot;Ticket&quot;</span><span class="p">,</span><span class="s2">&quot;Embarked&quot;</span><span class="p">,</span><span class="s2">&quot;Pclass&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">TargetEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span><span class="s2">&quot;Cabin&quot;</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">LREmbed</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span><span class="n">min_threshold</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">LGBMEmbed</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span><span class="n">min_threshold</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))</span>

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |   Pclass |   Name |   Sex |   SibSp |   Parch |    Cabin |   Embarked |
|----:|---------:|-------:|------:|--------:|--------:|---------:|-----------:|
| 500 |        1 |      0 |     1 |       0 |       0 | 0.317829 |          1 |
| 501 |        1 |      0 |     2 |       0 |       0 | 0.317829 |          3 |
| 502 |        1 |      0 |     2 |       0 |       0 | 0.317829 |          3 |
| 503 |        1 |      0 |     2 |       0 |       0 | 0.317829 |          1 |
| 504 |        2 |      0 |     2 |       0 |       0 | 0        |          1 |
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#查看LR权重分布</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">show_detail</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|    |   PassengerId |   Pclass |    Name |     Sex |        Age |    SibSp |     Parch |      Ticket |       Fare |   Cabin |   Embarked |
|---:|--------------:|---------:|--------:|--------:|-----------:|---------:|----------:|------------:|-----------:|--------:|-----------:|
|  0 |   0.000168929 | 0.200302 | 6.51026 | 1.03629 | 0.00765414 | 0.145938 | 0.0530416 | 0.000512668 | 0.00329262 | 0.90755 |   0.154712 |
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#查看Lgbm中split次数(默认)分布</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">show_detail</span><span class="p">()</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|    |   Pclass |   Name |   Sex |   SibSp |   Parch |   Cabin |   Embarked |
|---:|---------:|-------:|------:|--------:|--------:|--------:|-----------:|
|  0 |       35 |    100 |    12 |      16 |      16 |       4 |          7 |
</pre></div>
</div>
</section>
</section>
<section id="id11">
<h2>分类<a class="headerlink" href="#id11" title="此标题的永久链接">¶</a></h2>
<p>模型封装了很多，包括lgbm,lr,nb….等，具体可以查看后面的<code class="docutils literal notranslate"><span class="pre">API</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">easymlops.table.classification</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">OneHotEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span> <span class="s2">&quot;Sex&quot;</span><span class="p">],</span> <span class="n">drop_col</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> \
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">WOEEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ticket&quot;</span><span class="p">,</span> <span class="s2">&quot;Embarked&quot;</span><span class="p">,</span> <span class="s2">&quot;Cabin&quot;</span><span class="p">,</span> <span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="s2">&quot;Pclass&quot;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">))</span> \
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">LabelEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">LGBMClassification</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s2">&quot;死亡&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s2">&quot;存活&quot;</span><span class="p">}),</span><span class="n">native_init_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;max_depth&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span><span class="n">native_fit_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;num_boost_round&quot;</span><span class="p">:</span><span class="mi">128</span><span class="p">}))</span>

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |      死亡 |     存活 |
|----:|----------:|---------:|
| 500 | 0.923326  | 0.076674 |
| 501 | 0.373652  | 0.626348 |
| 502 | 0.37838   | 0.62162  |
| 503 | 0.670166  | 0.329834 |
| 504 | 0.0684703 | 0.93153  |
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#获取sabass特征重要性</span>
<span class="n">table</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_contrib</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">transform_single</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;record&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="n">run_to_layer</span><span class="o">=-</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;Sex&#39;: -0.5461501854144144,
 &#39;Cabin&#39;: -0.1270063345547848,
 &#39;Age&#39;: 0.05115085845832483,
 &#39;Fare&#39;: -0.1265214828241528,
 &#39;SibSp&#39;: 0.0441638895513395,
 &#39;Ticket&#39;: -0.005658456561668252,
 &#39;PassengerId&#39;: -0.2263838236137358,
 &#39;Pclass_2&#39;: -0.016025418181148575}
</pre></div>
</div>
</section>
<section id="id12">
<h2>回归建模<a class="headerlink" href="#id12" title="此标题的永久链接">¶</a></h2>
<p>目前只封装了lgbm，后续将会封装其他模型</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">easymlops.table.regression</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span><span class="o">=</span><span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">OneHotEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span> <span class="s2">&quot;Sex&quot;</span><span class="p">],</span> <span class="n">drop_col</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span> \
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">WOEEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Ticket&quot;</span><span class="p">,</span> <span class="s2">&quot;Embarked&quot;</span><span class="p">,</span> <span class="s2">&quot;Cabin&quot;</span><span class="p">,</span> <span class="s2">&quot;Sex&quot;</span><span class="p">,</span> <span class="s2">&quot;Pclass&quot;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">))</span> \
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">LabelEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">LGBMRegression</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span><span class="n">objective</span><span class="o">=</span><span class="s2">&quot;poisson&quot;</span><span class="p">))</span>

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |      pred |
|----:|----------:|
| 500 | 0.0929963 |
| 501 | 0.716432  |
| 502 | 0.654662  |
| 503 | 0.309583  |
| 504 | 0.916929  |
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#获取sabass特征重要性</span>
<span class="n">table</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_contrib</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">transform_single</span><span class="p">(</span><span class="n">x_test</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;record&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="n">run_to_layer</span><span class="o">=-</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;Sex&#39;: -0.5899834278029109,
 &#39;Cabin&#39;: -0.13150175316983173,
 &#39;Fare&#39;: -0.1301026457360956,
 &#39;Age&#39;: 0.275645992578784,
 &#39;PassengerId&#39;: -0.39285142163510006,
 &#39;Pclass_2&#39;: 0.0868239954973954,
 &#39;SibSp&#39;: 0.048242598427820915,
 &#39;Parch&#39;: -0.01823350433998343,
 &#39;Pclass&#39;: -0.01402473665988247,
 &#39;Ticket&#39;: -0.0030424253099006976,
 &#39;Embarked&#39;: -0.005601108385329127}
</pre></div>
</div>
</section>
<section id="stacking">
<h2>Stacking建模<a class="headerlink" href="#stacking" title="此标题的永久链接">¶</a></h2>
<p>主要通过<code class="docutils literal notranslate"><span class="pre">Parallel</span></code>的并行化实现<br />
注意：<code class="docutils literal notranslate"><span class="pre">Parallel</span></code>内部本质是顺序执行，如果后面pipe模块的输出col名称与前面有重复，将会覆盖，所以对于会被覆盖的col建议取别名，比如下面的<code class="docutils literal notranslate"><span class="pre">LabelEncoding</span></code>，通过设置<code class="docutils literal notranslate"><span class="pre">cols=[(原col1,新col1),(原col2,新col2)]</span></code>将新生成的结果赋值到新col中，而不改变原col的值</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">TablePipeLine</span><span class="p">()</span>
<span class="n">table</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FixInput</span><span class="p">())</span> \
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">FillNa</span><span class="p">())</span> \
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Parallel</span><span class="p">([</span><span class="n">OneHotEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span> <span class="s2">&quot;Sex&quot;</span><span class="p">]),</span> <span class="n">LabelEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;Sex&quot;</span><span class="p">,</span><span class="s2">&quot;Sex_label&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Pclass&quot;</span><span class="p">,</span><span class="s2">&quot;Pclass_label&quot;</span><span class="p">)]),</span>
                    <span class="n">TargetEncoding</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Ticket&quot;</span><span class="p">,</span> <span class="s2">&quot;Embarked&quot;</span><span class="p">,</span> <span class="s2">&quot;Cabin&quot;</span><span class="p">,</span> <span class="s2">&quot;Sex&quot;</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">)]))</span> \
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Parallel</span><span class="p">([</span><span class="n">PCADecomposition</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;pca&quot;</span><span class="p">),</span> <span class="n">NMFDecomposition</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;nmf&quot;</span><span class="p">)]))</span>\
  <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">Parallel</span><span class="p">([</span><span class="n">LGBMClassification</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s2">&quot;死亡&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s2">&quot;存活&quot;</span><span class="p">}),</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;lgbm&quot;</span><span class="p">),</span> <span class="n">LogisticRegressionClassification</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="o">.</span><span class="n">map</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="s2">&quot;死亡&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="s2">&quot;存活&quot;</span><span class="p">}),</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;lr&quot;</span><span class="p">)]))</span>

<span class="n">x_test_new</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_test_new</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">to_markdown</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>|     |   lgbm_死亡 |   lgbm_存活 |   lr_死亡 |   lr_存活 |
|----:|------------:|------------:|----------:|----------:|
| 500 |    0.970454 |   0.0295459 |  0.651447 |  0.348553 |
| 501 |    0.982422 |   0.0175782 |  0.655087 |  0.344913 |
| 502 |    0.972118 |   0.0278816 |  0.647448 |  0.352552 |
| 503 |    0.811991 |   0.188009  |  0.656522 |  0.343478 |
| 504 |    0.167515 |   0.832485  |  0.44925  |  0.55075  |
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cap1_introduce.html" class="btn btn-neutral float-left" title="简介&amp;安装&amp;反馈" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cap3_nlp.html" class="btn btn-neutral float-right" title="NLP任务" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2023, zhulei227.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>