# NLP任务  

目前该部分的功能还不多，主要是一些数据清洗以及特征提取的模块，如下以酒店评价数据集为例做演示



```python
#加载及切割数据
import os
os.chdir("../../")#与easymlops同级目录
import pandas as pd
data=pd.read_csv("./data/demo2.csv",encoding="gbk").sample(frac=1)
print(data.head(5).to_markdown())
```

    |      |   label | review                                                                                                                                                                                                                                                                                                                                                                                     |
    |-----:|--------:|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | 7009 |       0 | 后悔看了评价。上面老兄的要求也够低的。1）隔音太差2）早餐太差3）卫生间太小4）房间装修太差总的来说就是一经济性酒店。                                                                                                                                                                                                                                                                         |
    | 2985 |       1 | 非常不错的酒店，房间虽然不大但很精致，落地玻璃墙感觉视线宽阔。酒店服务也很到位，客房服务也很周到。购物、出游交通极为方便。下次去还会选择该酒店。                                                                                                                                                                                                                                           |
    | 7708 |       0 | 河南人就是河南人！不被懵一次，那算白来一回；在全国乃至全世界那种叫做经济房的房间，在河南济源雅士达叫做“贵宾楼”，真够逗的！！！                                                                                                                                                                                                                                                             |
    | 7401 |       0 | 这个酒店已经是破烂不堪了，楼道和房间内充满了发霉的味道，地毯脏兮兮的，洗手台的水龙头已经活动了，极度不好用。本来订了一个星期的房，入住当天就打算换酒店了，因为离办事的地点近，所以忍了两天，到了第三天实在无法忍受了，夜里闹蚊子啊！要命！！！酒店给的电蚊香根本不管用，只好换了一家据说没开多久的新酒店，虽然远点，但是比这里便宜的多，设施强太多了。强烈不建议入住此酒店，否则一定后悔。 |
    | 2255 |       1 | 在厦门岛内实地考察了很多家4星级标准酒店，认为这是性价比比较好的一家，位置还好，虽然设置不太新，但和其他几家挂牌4星且价格很贵的酒店相比也差不多。                                                                                                                                                                                                                                           |
    


```python
data.shape
```




    (7766, 2)




```python
x_train=data[:6000]
x_test=data[6000:]
y_train=x_train["label"]
y_test=x_test["label"]
del x_train["label"]
del x_test["label"]
```

## 文本处理

### 文本清洗  



```python
from easymlops import NLPPipeline
from easymlops.nlp.preprocessing import *
```

#### 转大小写
- Lower：所有英文字符转小写
- Upper：所有英文字符转大写


```python
nlp=NLPPipeline()
nlp.pipe(Lower())\
   .pipe(Upper())

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      | review                                                                                                                                                               |
    |-----:|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | 1744 | 感觉很您好环境也不错晚上很安静下次有机会还会选择住金叶的                                                                                                             |
    | 1979 | 酒店房间不错，就是价格偏高，餐饮很方便。就是距离市中心太远                                                                                                           |
    | 7739 | 1房间很小，地毯很脏，白毛巾显黑色2中央空调有异响，后半夜只好关掉3洗澡水忽冷忽热                                                                                      |
    | 3345 | 然市中心了些~（可是，坐地很方便的~）但是如果你在四~五周事情的~是不的~一般和司直接酒店的名字~司傅不知道在哪里~打的去的，得在慈云的西北角~以前的那里~有大的~酒店的整施 |
    | 1275 | 几乎是在凌晨才到的包头，包头也没有什么特别好的酒店，每次来了就是住在这家，所以也没有忒多的对比，感觉还行，下次还是得到这里来住                                       |
    

#### 处理数字

- RemoveDigits：移除字符串中的所有数字  
- ReplaceDigits：替换字符串中的所有数字为一个特殊字符`symbols="[d]"`


```python
nlp=NLPPipeline()
nlp.pipe(RemoveDigits())

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      | review                                                                                                                                                               |
    |-----:|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | 1744 | 感觉很您好环境也不错晚上很安静下次有机会还会选择住金叶的                                                                                                             |
    | 1979 | 酒店房间不错，就是价格偏高，餐饮很方便。就是距离市中心太远                                                                                                           |
    | 7739 | 房间很小，地毯很脏，白毛巾显黑色中央空调有异响，后半夜只好关掉洗澡水忽冷忽热                                                                                         |
    | 3345 | 然市中心了些~（可是，坐地很方便的~）但是如果你在四~五周事情的~是不的~一般和司直接酒店的名字~司傅不知道在哪里~打的去的，得在慈云的西北角~以前的那里~有大的~酒店的整施 |
    | 1275 | 几乎是在凌晨才到的包头，包头也没有什么特别好的酒店，每次来了就是住在这家，所以也没有忒多的对比，感觉还行，下次还是得到这里来住                                       |
    

#### 处理标点符号

- RemovePunctuation：移除字符串中的所有标点符号（中英文）  
- ReplacePunctuation：替换字符串中的所有标点符号为一个特殊字符`symbols="[p]"` 


```python
nlp=NLPPipeline()
nlp.pipe(RemovePunctuation())

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      | review                                                                                                                                             |
    |-----:|:---------------------------------------------------------------------------------------------------------------------------------------------------|
    | 1744 | 感觉很您好环境也不错晚上很安静下次有机会还会选择住金叶的                                                                                           |
    | 1979 | 酒店房间不错就是价格偏高餐饮很方便就是距离市中心太远                                                                                               |
    | 7739 | 1房间很小地毯很脏白毛巾显黑色2中央空调有异响后半夜只好关掉3洗澡水忽冷忽热                                                                          |
    | 3345 | 然市中心了些可是坐地很方便的但是如果你在四五周事情的是不的一般和司直接酒店的名字司傅不知道在哪里打的去的得在慈云的西北角以前的那里有大的酒店的整施 |
    | 1275 | 几乎是在凌晨才到的包头包头也没有什么特别好的酒店每次来了就是住在这家所以也没有忒多的对比感觉还行下次还是得到这里来住                               |
    

#### 移除空格
- RemoveWhitespace：移除空白字符，包括空格、指标、回车等  



```python
nlp=NLPPipeline()
nlp.pipe(RemoveWhitespace())

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      | review                                                                                                                                                               |
    |-----:|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | 1744 | 感觉很您好环境也不错晚上很安静下次有机会还会选择住金叶的                                                                                                             |
    | 1979 | 酒店房间不错，就是价格偏高，餐饮很方便。就是距离市中心太远                                                                                                           |
    | 7739 | 1房间很小，地毯很脏，白毛巾显黑色2中央空调有异响，后半夜只好关掉3洗澡水忽冷忽热                                                                                      |
    | 3345 | 然市中心了些~（可是，坐地很方便的~）但是如果你在四~五周事情的~是不的~一般和司直接酒店的名字~司傅不知道在哪里~打的去的，得在慈云的西北角~以前的那里~有大的~酒店的整施 |
    | 1275 | 几乎是在凌晨才到的包头，包头也没有什么特别好的酒店，每次来了就是住在这家，所以也没有忒多的对比，感觉还行，下次还是得到这里来住                                       |
    

#### 局部字符替换
- Replace：进行字符串的局部替换（注意easymlops.table.preprocessing.Replace只支持整个字符串的替换）


```python
nlp=NLPPipeline()
nlp.pipe(Replace(source_values=["酒店","宾馆","饭店"],target_value="[酒店]"))

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      | review                                                                                                                                                                   |
    |-----:|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | 1744 | 感觉很您好环境也不错晚上很安静下次有机会还会选择住金叶的                                                                                                                 |
    | 1979 | [酒店]房间不错，就是价格偏高，餐饮很方便。就是距离市中心太远                                                                                                             |
    | 7739 | 1房间很小，地毯很脏，白毛巾显黑色2中央空调有异响，后半夜只好关掉3洗澡水忽冷忽热                                                                                          |
    | 3345 | 然市中心了些~（可是，坐地很方便的~）但是如果你在四~五周事情的~是不的~一般和司直接[酒店]的名字~司傅不知道在哪里~打的去的，得在慈云的西北角~以前的那里~有大的~[酒店]的整施 |
    | 1275 | 几乎是在凌晨才到的包头，包头也没有什么特别好的[酒店]，每次来了就是住在这家，所以也没有忒多的对比，感觉还行，下次还是得到这里来住                                         |
    

#### 去停用词
- RemoveStopWords：移除停用词，通过`stop_words=["a","b"...]`或`stop_words_path=xxx/stopwords.txt`(换行分割)指定   

**注意：该模块需要在分词之后使用（词以空格的状态分割），使用方式放到后续中文分词中**

#### 提取中文字符
- ExtractChineseWords：仅提取字符串中的中文字符


```python
nlp=NLPPipeline()
nlp.pipe(ExtractChineseWords())

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      | review                                                                                                                                             |
    |-----:|:---------------------------------------------------------------------------------------------------------------------------------------------------|
    | 1744 | 感觉很您好环境也不错晚上很安静下次有机会还会选择住金叶的                                                                                           |
    | 1979 | 酒店房间不错就是价格偏高餐饮很方便就是距离市中心太远                                                                                               |
    | 7739 | 房间很小地毯很脏白毛巾显黑色中央空调有异响后半夜只好关掉洗澡水忽冷忽热                                                                             |
    | 3345 | 然市中心了些可是坐地很方便的但是如果你在四五周事情的是不的一般和司直接酒店的名字司傅不知道在哪里打的去的得在慈云的西北角以前的那里有大的酒店的整施 |
    | 1275 | 几乎是在凌晨才到的包头包头也没有什么特别好的酒店每次来了就是住在这家所以也没有忒多的对比感觉还行下次还是得到这里来住                               |
    

### 中文分词
- ExtractJieBaWords：目前只支持jieba分词，分词结果默认以空格分割   

注意，需要安装：`pip install jieba`


```python
nlp=NLPPipeline()
nlp.pipe(ExtractChineseWords())\
   .pipe(ExtractJieBaWords())\
   .pipe(RemoveStopWords(stop_words=["我","的","在","是","也","都"]))

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      | review                                                                                                                                                   |
    |-----:|:---------------------------------------------------------------------------------------------------------------------------------------------------------|
    | 1744 | 感觉 很 您好 环境 不错 晚上 很 安静 下次 有 机会 还会 选择 住 金叶                                                                                       |
    | 1979 | 酒店 房间 不错 就是 价格 偏高 餐饮 很 方便 就是 距离 市中心 太远                                                                                         |
    | 7739 | 房间 很小 地毯 很脏 白 毛巾 显 黑色 中央空调 有 异响 后半夜 只好 关掉 洗澡水 忽冷忽热                                                                    |
    | 3345 | 然 市中心 了 些 可是 坐地 很 方便 但是 如果 你 四五 周 事情 不 一般 和司 直接 酒店 名字 司傅 不 知道 哪里 打 去 得 慈云 西北角 以前 那里 有 大 酒店 整施 |
    | 1275 | 几乎 凌晨 才 到 包头 包头 没有 什么 特别 好 酒店 每次 来 了 就是 住 这家 所以 没有 忒 多 对比 感觉 还 行 下次 还是 得到 这里 来 住                       |
    

### 关键词抽取
- ExtractKeyWords：抽取`key_words=["kw1","kw2"]`或`key_words_path=xxx/keyword.txt`指定的关键词；  
- AppendKeyWords：将抽取的关键词拼接到原文后面  

注意，这里需要`pip install pyahocorasick`


```python
nlp=NLPPipeline()
nlp.pipe(ExtractKeyWords(key_words=["安静","环境","晚上","酒店","餐饮","价格","中央空调","毛巾","市中心","方便","前台","实惠","携程","房间","卫生"]))

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      | review                          |
    |-----:|:--------------------------------|
    | 1744 | 环境 晚上 安静                  |
    | 1979 | 酒店 房间 价格 餐饮 方便 市中心 |
    | 7739 | 房间 毛巾 中央空调              |
    | 3345 | 市中心 方便 酒店 酒店           |
    | 1275 | 酒店                            |
    

### 提取N-gram
- ExtractNGramWords，通过设置`n_grams=[1,2,3]`以支持2-gram,3-gram的拼接


```python
nlp=NLPPipeline()
nlp.pipe(ExtractKeyWords(key_words=["安静","环境","晚上","酒店","餐饮","价格","中央空调","毛巾","市中心","方便","前台","实惠","携程","房间","卫生"]))\
   .pipe(ExtractNGramWords(n_grams=[2]))

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      | review                                         |
    |-----:|:-----------------------------------------------|
    | 1744 | 环境晚上 晚上安静                              |
    | 1979 | 酒店房间 房间价格 价格餐饮 餐饮方便 方便市中心 |
    | 7739 | 房间毛巾 毛巾中央空调                          |
    | 3345 | 市中心方便 方便酒店 酒店酒店                   |
    | 1275 | 酒店                                           |
    

## 文本特征提取

主要三类特征  
- bow/tfidf等常用特征  
- lsi/lda等主题模型特征  
- fastext/word2vec/doc2vec等词向量特征

这些pipe模块的前置模块即是前面的文本处理结果，**注意：处理好的token要求空格分割**

### Bag-of-Words特征提取 


```python
from easymlops.nlp.representation import *
```


```python
nlp=NLPPipeline()
nlp.pipe(ExtractChineseWords())\
   .pipe(ExtractJieBaWords())\
   .pipe(BagOfWords())

x_test_new=nlp.fit(x_train).transform(x_test)
#选择前10个columns展示
top_10_cols=x_test_new.columns.tolist()[:10]
print(x_test_new[top_10_cols].head(5).to_markdown())
```

    |      |   bag_review_ |   bag_review_一 |   bag_review_一一 |   bag_review_一一列举 |   bag_review_一丁点 |   bag_review_一上 |   bag_review_一下 |   bag_review_一下下 |   bag_review_一下子 |   bag_review_一下床 |
    |-----:|--------------:|----------------:|------------------:|----------------------:|--------------------:|------------------:|------------------:|--------------------:|--------------------:|--------------------:|
    | 1744 |             0 |               0 |                 0 |                     0 |                   0 |                 0 |                 0 |                   0 |                   0 |                   0 |
    | 1979 |             0 |               0 |                 0 |                     0 |                   0 |                 0 |                 0 |                   0 |                   0 |                   0 |
    | 7739 |             0 |               0 |                 0 |                     0 |                   0 |                 0 |                 0 |                   0 |                   0 |                   0 |
    | 3345 |             0 |               0 |                 0 |                     0 |                   0 |                 0 |                 0 |                   0 |                   0 |                   0 |
    | 1275 |             0 |               0 |                 0 |                     0 |                   0 |                 0 |                 0 |                   0 |                   0 |                   0 |
    

### TFIDF特征提取


```python
nlp=NLPPipeline()
nlp.pipe(ExtractChineseWords())\
   .pipe(ExtractJieBaWords())\
   .pipe(TFIDF())

x_test_new=nlp.fit(x_train).transform(x_test)
#选择前10个columns展示
top_10_cols=x_test_new.columns.tolist()[:10]
print(x_test_new[top_10_cols].head(5).to_markdown())
```

    |      |   tfidf_review_ |   tfidf_review_一 |   tfidf_review_一一 |   tfidf_review_一一列举 |   tfidf_review_一丁点 |   tfidf_review_一上 |   tfidf_review_一下 |   tfidf_review_一下下 |   tfidf_review_一下子 |   tfidf_review_一下床 |
    |-----:|----------------:|------------------:|--------------------:|------------------------:|----------------------:|--------------------:|--------------------:|----------------------:|----------------------:|----------------------:|
    | 1744 |               0 |                 0 |                   0 |                       0 |                     0 |                   0 |                   0 |                     0 |                     0 |                     0 |
    | 1979 |               0 |                 0 |                   0 |                       0 |                     0 |                   0 |                   0 |                     0 |                     0 |                     0 |
    | 7739 |               0 |                 0 |                   0 |                       0 |                     0 |                   0 |                   0 |                     0 |                     0 |                     0 |
    | 3345 |               0 |                 0 |                   0 |                       0 |                     0 |                   0 |                   0 |                     0 |                     0 |                     0 |
    | 1275 |               0 |                 0 |                   0 |                       0 |                     0 |                   0 |                   0 |                     0 |                     0 |                     0 |
    

### LDA主题特征提取  
这里需要`pip install gensim`


```python
nlp=NLPPipeline()
nlp.pipe(ExtractChineseWords())\
   .pipe(ExtractJieBaWords())\
   .pipe(LdaTopicModel(num_topics=10))

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      |   lda_review_0 |   lda_review_1 |   lda_review_2 |   lda_review_3 |   lda_review_4 |   lda_review_5 |   lda_review_6 |   lda_review_7 |   lda_review_8 |   lda_review_9 |
    |-----:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|
    | 1744 |              0 |              0 |       0        |              0 |              0 |       0.949877 |              0 |       0        |       0        |              0 |
    | 1979 |              0 |              0 |       0        |              0 |              0 |       0        |              0 |       0.935684 |       0        |              0 |
    | 7739 |              0 |              0 |       0        |              0 |              0 |       0.652724 |              0 |       0        |       0.296957 |              0 |
    | 3345 |              0 |              0 |       0.114297 |              0 |              0 |       0.867174 |              0 |       0        |       0        |              0 |
    | 1275 |              0 |              0 |       0.463728 |              0 |              0 |       0.515751 |              0 |       0        |       0        |              0 |
    

### LSI主题特征提取


```python
nlp=NLPPipeline()
nlp.pipe(ExtractChineseWords())\
   .pipe(ExtractJieBaWords())\
   .pipe(LsiTopicModel(num_topics=10))

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      |   lsi_review_0 |   lsi_review_1 |   lsi_review_2 |   lsi_review_3 |   lsi_review_4 |   lsi_review_5 |   lsi_review_6 |   lsi_review_7 |   lsi_review_8 |   lsi_review_9 |
    |-----:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|
    | 1744 |       1.39954  |     -0.975097  |      -1.54407  |      0.415277  |     1.0714     |     -0.746387  |      -0.292458 |     -0.438556  |      0.0561642 |       0.274336 |
    | 1979 |       0.592186 |     -0.45394   |      -1.55082  |     -0.526192  |     0.204988   |     -0.0423063 |       0.221982 |      0.384767  |     -0.348087  |       0.234508 |
    | 7739 |       0.225825 |     -0.0522641 |      -0.332167 |      0.0997599 |     0.0927111  |      0.11295   |       0.535794 |      0.734816  |     -0.148433  |      -0.347115 |
    | 3345 |       9.64813  |     -3.12374   |       1.97081  |     -0.369649  |     0.00582721 |      0.124639  |      -2.00917  |      0.0256526 |      0.667923  |      -1.63593  |
    | 1275 |       4.19027  |     -0.449885  |      -0.775973 |      0.308142  |    -0.21447    |      0.7491    |      -0.627831 |      0.124285  |      1.53927   |       0.461568 |
    

### Word2Vec词向量特征
这里的文档特征是每个token词向量的平均值


```python
nlp=NLPPipeline()
nlp.pipe(ExtractChineseWords())\
   .pipe(ExtractJieBaWords())\
   .pipe(Word2VecModel(embedding_size=10))

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      |   w2v_review_0 |   w2v_review_1 |   w2v_review_2 |   w2v_review_3 |   w2v_review_4 |   w2v_review_5 |   w2v_review_6 |   w2v_review_7 |   w2v_review_8 |   w2v_review_9 |
    |-----:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|
    | 1744 |       2.59696  |      -0.509485 |       0.747802 |      -0.18188  |      1.28394   |     -1.18842   |        1.91821 |       1.24181  |      -0.678357 |      -1.09977  |
    | 1979 |       1.52598  |      -0.795458 |       0.71885  |       1.34891  |      1.48434   |     -1.5375    |        1.61953 |       1.27964  |      -0.515284 |      -0.908169 |
    | 7739 |      -0.251851 |       0.385614 |       0.545009 |       0.55778  |      1.07805   |     -0.317936  |        1.40886 |       0.14875  |      -0.995156 |      -0.816315 |
    | 3345 |       0.7642   |      -0.168515 |       0.841319 |       0.253198 |      0.0759531 |     -0.413605  |        1.57715 |       0.957489 |      -1.15848  |      -1.05049  |
    | 1275 |       1.19975  |      -0.610869 |       1.00963  |      -0.24102  |      0.345251  |     -0.0734133 |        1.72452 |       0.558599 |      -0.838714 |      -1.17406  |
    

### Doc2Vec文档向量


```python
nlp=NLPPipeline()
nlp.pipe(ExtractChineseWords())\
   .pipe(ExtractJieBaWords())\
   .pipe(Doc2VecModel(embedding_size=10))

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      |   d2v_review_0 |   d2v_review_1 |   d2v_review_2 |   d2v_review_3 |   d2v_review_4 |   d2v_review_5 |   d2v_review_6 |   d2v_review_7 |   d2v_review_8 |   d2v_review_9 |
    |-----:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|---------------:|
    | 1744 |    -0.0128357  |     0.00691763 |     -0.178617  |     -0.0168102 |       0.207676 |     0.00593338 |       0.148199 |      0.0861719 |     -0.0969737 |      0.132832  |
    | 1979 |    -0.0272897  |    -0.108906   |      0.0702583 |      0.0795282 |       0.201975 |    -0.0487761  |       0.295727 |      0.206678  |     -0.19725   |     -0.0392033 |
    | 7739 |    -0.00476251 |    -0.135498   |      0.272658  |      0.0899163 |       0.276086 |    -0.0758654  |       0.300075 |      0.248316  |     -0.537512  |     -0.1504    |
    | 3345 |     0.0417817  |    -0.140148   |      0.0606817 |      0.171176  |      -0.102886 |     0.0545042  |       0.270832 |      0.0481053 |      0.0098604 |      0.0864315 |
    | 1275 |     0.0303072  |    -0.312212   |      0.230832  |     -0.0974685 |       0.222709 |     0.130519   |       0.496232 |      0.282865  |     -0.365583  |     -0.0604666 |
    

### FastText词向量


```python
nlp=NLPPipeline()
nlp.pipe(ExtractChineseWords())\
   .pipe(ExtractJieBaWords())\
   .pipe(FastTextModel(embedding_size=10))

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      |   fasttext_review_0 |   fasttext_review_1 |   fasttext_review_2 |   fasttext_review_3 |   fasttext_review_4 |   fasttext_review_5 |   fasttext_review_6 |   fasttext_review_7 |   fasttext_review_8 |   fasttext_review_9 |
    |-----:|--------------------:|--------------------:|--------------------:|--------------------:|--------------------:|--------------------:|--------------------:|--------------------:|--------------------:|--------------------:|
    | 1744 |            1.15908  |           0.0846844 |            1.80972  |            0.785799 |           -0.253501 |           -0.803011 |             2.90578 |            1.7224   |          -0.261663  |           -0.995197 |
    | 1979 |            0.688347 |           0.284998  |            1.30195  |            1.1203   |           -1.50913  |           -0.864073 |             3.08464 |            1.09104  |           0.247171  |           -0.611336 |
    | 7739 |           -0.498782 |          -0.551721  |            0.737703 |            0.580404 |           -0.63984  |           -0.91394  |             1.11849 |           -0.178209 |           0.0361348 |           -1.06214  |
    | 3345 |           -0.129938 |          -0.853439  |            1.3639   |            0.847106 |           -0.59885  |           -0.633    |             1.28703 |            0.8617   |          -0.558433  |           -0.471137 |
    | 1275 |            0.236073 |          -0.830615  |            2.19249  |            0.407859 |           -0.124791 |           -0.497834 |             1.81298 |            0.994725 |          -0.682955  |           -0.307372 |
    

## 文本分类
借助于table中的分类器，可以做文本分类任务了


```python
from easymlops.table.classification import LGBMClassification
```


```python
nlp=NLPPipeline()
nlp.pipe(ExtractChineseWords())\
   .pipe(ExtractJieBaWords())\
   .pipe(BagOfWords())\
   .pipe(LGBMClassification(y=y_train.map({1:"差评",0:"好评"})))

x_test_new=nlp.fit(x_train).transform(x_test)
print(x_test_new.head(5).to_markdown())
```

    |      |     差评 |       好评 |
    |-----:|---------:|-----------:|
    | 1744 | 0.996622 | 0.00337761 |
    | 1979 | 0.986792 | 0.0132082  |
    | 7739 | 0.258539 | 0.741461   |
    | 3345 | 0.527271 | 0.472729   |
    | 1275 | 0.888017 | 0.111983   |
    


```python

```
